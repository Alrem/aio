---

  - hosts: aio
    gather_facts: False
    tasks:

      - name: Add extra packages
        apt:
          name: "{{ item }}"
          state: present
          update_cache: yes
        with_items:
          - apt-transport-https
          - ca-certificates
        become: yes

      - name:  Add the GPG key for the official Docker repository
        apt_key:
          url: https://download.docker.com/linux/ubuntu/gpg
          state: present
        become: yes

      - name: Add the Docker repository to APT sources
        apt_repository:
          repo: 'deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial stable'
          state: present
        become: yes

      # - name: update software
      #   apt: update_cache=yes upgrade=dist
      #   become: yes

      - name: Install Docker
        apt: name=docker-ce state=present update_cache=yes
        notify: Restart Docker
        become: yes

    handlers:
      - name: Restart Docker
        service:
          name: docker
          state: restarted
        become: yes
